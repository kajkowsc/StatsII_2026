rm(list=ls())
# detach all libraries
detachAllPackages <- function() {
basic.packages <- c("package:stats", "package:graphics", "package:grDevices", "package:utils", "package:datasets", "package:methods", "package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:", search()))==1, TRUE, FALSE)]
package.list <- setdiff(package.list, basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package,  character.only=TRUE)
}
detachAllPackages()
pkgTest <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[,  "Package"])]
if (length(new.pkg))
install.packages(new.pkg,  dependencies = TRUE)
sapply(pkg,  require,  character.only = TRUE)
}
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
lapply(c(),  pkgTest)
set.seed(123)
# create empirical distribution of observed data
ECDF <- ecdf(data)
# remove objects
rm(list=ls())
# detach all libraries
detachAllPackages <- function() {
basic.packages <- c("package:stats", "package:graphics", "package:grDevices", "package:utils", "package:datasets", "package:methods", "package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:", search()))==1, TRUE, FALSE)]
package.list <- setdiff(package.list, basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package,  character.only=TRUE)
}
detachAllPackages()
# load libraries
pkgTest <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[,  "Package"])]
if (length(new.pkg))
install.packages(new.pkg,  dependencies = TRUE)
sapply(pkg,  require,  character.only = TRUE)
}
lapply(c(),  pkgTest)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
set.seed(123)
ECDF <- ecdf(data)
set.seed (123)
data <- data.frame(x = runif(200, 1, 10))
data$y <- 0 + 2.75*data$x + rnorm(200, 0, 1.5)
rm(list=ls())
# detach all libraries
detachAllPackages <- function() {
basic.packages <- c("package:stats", "package:graphics", "package:grDevices", "package:utils", "package:datasets", "package:methods", "package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:", search()))==1, TRUE, FALSE)]
package.list <- setdiff(package.list, basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package,  character.only=TRUE)
}
detachAllPackages()
# load libraries
pkgTest <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[,  "Package"])]
if (length(new.pkg))
install.packages(new.pkg,  dependencies = TRUE)
sapply(pkg,  require,  character.only = TRUE)
}
lapply(c(),  pkgTest)
# set wd for current folder
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
set.seed(123)
# create empirical distribution of observed data
ECDF <- ecdf(data)
data <- (rcauchy(1000, location = 0, scale = 1))
# create empirical distribution of observed data
ECDF <- ecdf(data)
empiricalCDF <- ECDF(data)
k <- length
ECDF <- ecdf(data)
empiricalCDF <- ECDF(data)
D <- max(abs(empiricalCDF - pnorm(data)))
expo <- exp(-((2*i - 1)^2) * pi^2)/(8(d^2))
KolSmi_test <- function(data)
k <- length
i <- 1:k
KolSmi_test <- function(data) {
k <- length
i <- 1:k
ECDF <- ecdf(data)
empiricalCDF <- ECDF(data)
d <- max(abs(empiricalCDF - pnorm(data)))
expo <- exp(-((2*i - 1)^2) * pi^2)/(8(d^2))
prob_d <- sqrt(2 * pi)/d * sum(expo)
return(prob_d)
}
View(KolSmi_test)
KolSmi_test(data)
KolSmi_test <- function(data) {
k <- length(data)
i <- 1:k
ECDF <- ecdf(data)
empiricalCDF <- ECDF(data)
d <- max(abs(empiricalCDF - pnorm(data)))
expo <- exp(-((2*i - 1)^2) * pi^2)/(8(d^2))
prob_d <- sqrt(2 * pi)/d * sum(expo)
return(prob_d)
}
KolSmi_test(data)
KolSmi_test <- function(data) {
k <- length(data)
i <- 1:k
ECDF <- ecdf(data)
empiricalCDF <- ECDF(data)
d <- max(abs(empiricalCDF - pnorm(data)))
expo <- exp(-((2*i - 1)^2) * pi^2)/(8 * (d^2))
prob_d <- sqrt(2 * pi)/d * sum(expo)
return(prob_d)
}
KolSmi_test(data)
KolSmi_test <- function(data) {
data <- data[[1]]
k <- length(data)
i <- 1:k
ECDF <- ecdf(data)
empiricalCDF <- ECDF(data)
d <- max(abs(empiricalCDF - pnorm(data)))
expo <- exp(-((2*i - 1)^2) * pi^2)/(8 * (d^2))
prob_d <- sqrt(2 * pi)/d * sum(expo)
return(prob_d)
}
KolSmi_test(data)
set.seed(123)
data <- (rcauchy(1000, location = 0, scale = 1))
KolSmi_test <- function(data) {
data <- data[[1]]
k <- length(data)
i <- 1:k
ECDF <- ecdf(data)
empiricalCDF <- ECDF(data)
d <- max(abs(empiricalCDF - pnorm(data)))
expo <- exp(-((2*i - 1)^2) * pi^2)/(8 * (d^2))
prob_d <- sqrt(2 * pi)/d * sum(expo)
return(prob_d)
}
KolSmi_test(data)
set.seed(123)
data <- (rcauchy(1000, location = 0, scale = 1))
# create empirical distribution of observed data
# generate test statistic
KolSmi_test <- function(data) {
k <- length(data)
i <- 1:k
ECDF <- ecdf(data)
empiricalCDF <- ECDF(data)
d <- max(abs(empiricalCDF - pnorm(data)))
expo <- exp(-((2*i - 1)^2) * pi^2)/(8 * (d^2))
d_obs <- sqrt(2 * pi)/d * sum(expo)
return(d_obs)
}
KolSmi_test(data)
KolSmi_test <- function(data) {
k <- length(data)
ECDF <- ecdf(data)
empiricalCDF <- ECDF(data)
d <- max(abs(empiricalCDF - pnorm(data)))
i <- 1:k
expo <- exp(-((2*i - 1)^2) * pi^2)/(8 * (d^2))
d_obs <- sqrt(2 * pi)/d * sum(expo)
return(d_obs)
}
KolSmi_test(data)
KolSmi_test <- function(data) {
k <- length(data)
ECDF <- ecdf(data)
empiricalCDF <- ECDF(data)
d_value <- max(abs(empiricalCDF - pnorm(data)))
i <- 1:k
expo <- exp(-((2*i - 1)^2) * pi^2)/(8 * (d_value^2))
d_obs <- sqrt(2 * pi)/d_value * sum(expo)
return(d_obs)
}
KolSmi_test(data)
set.seed(123)
data <- (rcauchy(1000, location = 0, scale = 1))
KSpval <- function(data) {
data <- data[[1]] #explicitly assuming one column to prevent ecdf error
k <- length(data) #setting the length of K
ECDF <- ecdf(data) #creating empirical distribution of observed data
empiricalCDF <- ECDF(data) #creating empirical distribution
d_value <- max(abs(empiricalCDF - pnorm(data))) #test statistic
i <- 1:k #taking a vectorized approach instead of a loop for calculating the terms
terms <- exp(-((2*i - 1)^2) * pi^2)/(8*(d_value^2)) #calculating the terms for all 100 k's
d_obs <- sqrt(2 * pi)/d_value * sum(terms) #calculating the observation
return(d_obs)
}
KSpval(data)
set.seed(123)
data <- (rcauchy(1000, location = 0, scale = 1))
KSpval <- function(data) {
data <- data[[1]] #explicitly assuming one column to prevent ecdf error
k <- length(data) #setting the length of K
ECDF <- ecdf(data) #creating empirical distribution of observed data
empiricalCDF <- ECDF(data) #creating empirical distribution
d_value <- max(abs(empiricalCDF - pnorm(data))) #test statistic
i <- 1:k #taking a vectorized approach instead of a loop for calculating the terms
terms <- exp(-((2*i - 1)^2) * pi^2)/(8*(d_value^2)) #calculating the terms for all 100 k's
d_obs <- sqrt(2 * pi)/d_value * sum(terms) #calculating the observation
return(d_obs)
}
KSpval(data)
set.seed(123)
data <- (rcauchy(1000, location = 0, scale = 1))
KSpval <- function(data) {
data <- data[[1]] #explicitly assuming one column to prevent ecdf error
k <- length(data) #setting the length of K
ECDF <- ecdf(data) #creating empirical distribution of observed data
empiricalCDF <- ECDF(data) #creating empirical distribution
d_value <- max(abs(empiricalCDF - pnorm(data))) #test statistic
i <- 1:k #taking a vectorized approach instead of a loop for calculating the terms
terms <- exp(-((2*i - 1)^2) * pi^2)/(8*(d_value^2)) #calculating the terms for all 100 k's
d_obs <- sqrt(2 * pi)/d_value * sum(terms) #calculating the observation
return(d_obs)
}
KSpval(data)
KolSmi_test <- function(data, n_terms = 100) {
k <- length(data)
ECDF <- ecdf(data)
empiricalCDF <- ECDF(data)
d_value <- max(abs(empiricalCDF - pnorm(data)))
i <- 1:k #creatinf the iteration through terms for the expo calculation
expo <- exp(-((2*i - 1)^2) * pi^2)/(8 * (d_value^2))
d_obs <- sqrt(2 * pi)/d_value * sum(expo)
return(d_obs)
}
KolSmi_test(data)
KolSmi_test <- function(data, n_terms = 100) {
ECDF <- ecdf(data)
empiricalCDF <- ECDF(data)
d_value <- max(abs(empiricalCDF - pnorm(data)))
i <- 1:n_terms #creating the iteration through terms for the expo calculation
expo <- exp(-((2*i - 1)^2) * pi^2)/(8 * (d_value^2))
d_obs <- sqrt(2 * pi)/d_value * sum(expo)
return(d_obs)
}
KolSmi_test(data)
ECDF <- ecdf(data)
empiricalCDF <- ECDF(data)
d_value <- max(abs(empiricalCDF - pnorm(data)))
KolSmi_test <- function(data) {
k <- length(data)
i <- 1:k #creating the iteration through terms for the expo calculation
expo <- exp(-((2*i - 1)^2) * pi^2)/(8 * (d_value^2))
d_obs <- sqrt(2 * pi)/d_value * sum(expo)
return(d_obs)
}
KolSmi_test(data)
ECDF <- ecdf(data)
empiricalCDF <- ECDF(data)
d_value <- max(abs(empiricalCDF - pnorm(data)))
set.seed(123)
data <- (rcauchy(1000, location = 0, scale = 1))
# remove objects
rm(list=ls())
# detach all libraries
detachAllPackages <- function() {
basic.packages <- c("package:stats", "package:graphics", "package:grDevices", "package:utils", "package:datasets", "package:methods", "package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:", search()))==1, TRUE, FALSE)]
package.list <- setdiff(package.list, basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package,  character.only=TRUE)
}
detachAllPackages()
# load libraries
pkgTest <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[,  "Package"])]
if (length(new.pkg))
install.packages(new.pkg,  dependencies = TRUE)
sapply(pkg,  require,  character.only = TRUE)
}
lapply(c(),  pkgTest)
# set wd for current folder
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
set.seed(123)
data <- (rcauchy(1000, location = 0, scale = 1))
# create empirical distribution of observed data
# generate test statistic
ECDF <- ecdf(data)
empiricalCDF <- ECDF(data)
d_value <- max(abs(empiricalCDF - pnorm(data)))
KolSmi_test <- function(data) {
k <- length(data)
i <- 1:k #creating the iteration through terms for the expo calculation
expo <- exp(-((2*i - 1)^2) * pi^2)/(8 * (d_value^2))
d_obs <- sqrt(2 * pi)/d_value * sum(expo)
return(d_obs)
}
KolSmi_test(data)
set.seed (123)
data <- data.frame(x = runif(200, 1, 10))
data$y <- 0 + 2.75*data$x + rnorm(200, 0, 1.5)
new_raph <- function(outcome, input, parameter) {
residu <- data$y - (parameter[1] + parameter[2]*input)
sum_resud <- sum(residu^2)
}
results_nr <- optim(fn=new_raph, outcome=data$y, input = data$x, par=c(0,1),method="BFGS")
results_nr$par
coef(glm(data$y~data$x))
set.seed (123)
data <- data.frame(x = runif(200, 1, 10))
data$y <- 0 + 2.75*data$x + rnorm(200, 0, 1.5)
new_raph <- function(outcome, input, parameter) {
residu <- data$y - (parameter[1] + parameter[2]*input)
sum_resud <- sum(residu^2)
}
results_nr <- optim(fn=new_raph, outcome=data$y, input = data$x, par=c(0,1),method="BFGS")
results_nr$par
#  results_nr$par
#[1] 0.139187 2.726699
coef(lm(data$y~data$x))
set.seed (123)
data <- data.frame(x = runif(200, 1, 10))
data$y <- 0 + 2.75*data$x + rnorm(200, 0, 1.5)
new_raph <- function(outcome, input, parameter) {
residu <- data$y - (parameter[1] + parameter[2]*input)
sum_resud <- sum(residu^2)
}
results_nr <- optim(fn=new_raph, outcome=data$y, input = data$x, par=c(0,1),method="BFGS")
results_nr$par
# remove objects
rm(list=ls())
# detach all libraries
detachAllPackages <- function() {
basic.packages <- c("package:stats", "package:graphics", "package:grDevices", "package:utils", "package:datasets", "package:methods", "package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:", search()))==1, TRUE, FALSE)]
package.list <- setdiff(package.list, basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package,  character.only=TRUE)
}
detachAllPackages()
# load libraries
pkgTest <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[,  "Package"])]
if (length(new.pkg))
install.packages(new.pkg,  dependencies = TRUE)
sapply(pkg,  require,  character.only = TRUE)
}
lapply(c(),  pkgTest)
# set wd for current folder
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
set.seed(123)
data <- (rcauchy(1000, location = 0, scale = 1))
# create empirical distribution of observed data
# generate test statistic
ECDF <- ecdf(data)
empiricalCDF <- ECDF(data)
d_value <- max(abs(empiricalCDF - pnorm(data)))
KolSmi_test <- function(data) {
k <- length(data)
i <- 1:k #creating the iteration through terms for the expo calculation
expo <- exp(-((2*i - 1)^2) * pi^2)/(8 * (d_value^2))
d_obs <- (sqrt(2 * pi)/d_value) * sum(expo)
return(d_obs)
}
KolSmi_test(data)
k.test(data, "pnorm")
ks.test(data, "pnorm")
i <- 1:length(data)
i
expo
expo <- exp(-((2*i - 1)^2) * pi^2)/(8 * (d_value^2))
expo
i <- 1:length(data)
i
expo <- exp((-(2*i - 1))^2 * pi^2)/((8 * d_value^2))
p_value <- (sqrt(2 * pi)/d_value) * sum(expo)
return(d_obs)
expo
expo <- exp((-(2*i - 1)^2 * pi^2)/((8 * d_value^2))
p_value <- (sqrt(2 * pi)/d_value) * sum(expo)
expo <- exp((-(2*i - 1)^2 * pi^2)/(8 * d_value^2))
expo
expo <- exp(-((2*i - 1)^2) * pi^2)/(8 * (d_value^2))
expo
d_value <- max(abs(empiricalCDF - pnorm(data)))
d_value
ks.test(data, "pnorm")
KolSmi_test(data)
set.seed(123)
data <- (rcauchy(1000, location = 0, scale = 1))
# create empirical distribution of observed data
# generate test statistic
ECDF <- ecdf(data)
empiricalCDF <- ECDF(data)
d_value <- max(abs(empiricalCDF - pnorm(data)))
KolSmi_test <- function(data) {
i <- 1:length(data)
expo <- exp(-((2*i - 1)^2) * pi^2)/(8 * (d_value^2))
p_value <- (sqrt(2 * pi)/d_value) * sum(expo)
return(p_value)
}
KolSmi_test(data)
#[1] 0.006626909
ks.test(data, "pnorm")
