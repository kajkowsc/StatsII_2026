# remove objects
rm(list=ls())
# detach all libraries
detachAllPackages <- function() {
basic.packages <- c("package:stats", "package:graphics", "package:grDevices", "package:utils", "package:datasets", "package:methods", "package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:", search()))==1, TRUE, FALSE)]
package.list <- setdiff(package.list, basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package,  character.only=TRUE)
}
detachAllPackages()
# load libraries
pkgTest <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[,  "Package"])]
if (length(new.pkg))
install.packages(new.pkg,  dependencies = TRUE)
sapply(pkg,  require,  character.only = TRUE)
}
lapply(c(),  pkgTest)
# set wd for current folder
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
graduation <- read.table("http://statmath.wu.ac.at/courses/StatsWithR/Powers.txt")
str(graduation)
hsgrad <- as.factor(graduation$hsgrad)
graduation <- read.table("http://statmath.wu.ac.at/courses/StatsWithR/Powers.txt")
str(graduation)
nonwhite <- as.factor(graduation$nonwhite)
mhs <- as.factor(graduation$mhs)
fhs <- as.factor(graduation$fhs)
intact <- as.factor(graduation$intact)
yn_vars <- c("hsgrad", "nonwhite", "mhs", "fhs", "intact")
graduation[ynvars] <- lapply(graduation[yn_vars], factor)
yn_vars <- c("hsgrad", "nonwhite", "mhs", "fhs", "intact")
graduation[ynvars] <- lapply(graduation[yn_vars], factor)
lapply(c(),  pkgTest)
# set wd for current folder
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
graduation <- read.table("http://statmath.wu.ac.at/courses/StatsWithR/Powers.txt")
str(graduation)
yn_vars <- c("hsgrad", "nonwhite", "mhs", "fhs", "intact")
graduation[ynvars] <- lapply(graduation[yn_vars], factor)
graduation[yn_vars] <- lapply(graduation[yn_vars], factor)
str(graduation)
# (a) Perform a logistic regression of hsgrad on tfactor# (a) Perform a logistic regression of hsgrad on the other variables in the data set.
log_one <- glm(data = graduation, hsgrad ~ nonwhite + mhs + fhs + income + asvab + nsibs + intact, family = binomial(link = "logit"))
summary(log_one)
# Compute a likelihood-ratio test of the omnibus null hypothesis that none of the explanatory variables influences high-school graduation.
anova(graduation, log_one, test = "LRT")
View(graduation)
# Compute a likelihood-ratio test of the omnibus null hypothesis that none of the explanatory variables influences high-school graduation.
null_model <- glm(hsgrad ~ 1,
data = graduation,
family = binomial)
anova(null_model, log_one, test = "LRT")
# Then construct 95-percent confidence intervals for the coefficients of the seven explanatory variables.
confint(log_one)
# (b) The logistic regression in the previous problem assumes that the partial relationship between the log-odds of high-school graduation and number of siblings is linear.
graduation$nibs_f <- factor(graduation$nsibs)
# Test for nonlinearity by fitting a model that treats nsibs as a factor, performing an appropriate likelihood-ratio test.
m_factor <- glm(
hsgrad ~ nonwhite + mhs + fhs + income + asvab + nsibs_f + intact,
family = binomial
)
m_factor <- glm(
hsgrad ~ nonwhite + mhs + fhs + income + asvab + nsibs_f + intact,
data = graduation,
family = binomial
)
# (b) The logistic regression in the previous problem assumes that the partial relationship between the log-odds of high-school graduation and number of siblings is linear.
graduation$nibs_f <- factor(graduation$nsibs)
# (b) The logistic regression in the previous problem assumes that the partial relationship between the log-odds of high-school graduation and number of siblings is linear.
graduation$nsibs_f <- factor(graduation$nsibs)
summary(m_factor)
# Test for nonlinearity by fitting a model that treats nsibs as a factor, performing an appropriate likelihood-ratio test.
m_factor <- glm(
hsgrad ~ nonwhite + mhs + fhs + income + asvab + nsibs_f + intact,
data = graduation,
family = binomial
)
summary(m_factor)
anova(log_one, m_factor, test = "LRT")
#nsibs_f did not improve the model bc the p value is morse than the alpha 0.5
#the standard errors are large
unique(graduation$nibs_f)
table(graduation$nibs_f)
graduation_clean <- subset(graduation, nsibs >= 0)
graduation_clean$nsibs_cat <- cut(
graduation_clean$nsibs,
breaks= c(-1, 1, 3, 5, 10, 20),
labels = c("0-1", "2-3", "4-5", "6-10", "11+")
)
unique(graduation_clean$nsibs_cat)
table(graduation_clean$nsibs,graduation_clean$nsibs_cat)
m_factor2 <- glm(
hsgrad ~ nonwhite + mhs + fhs + income + asvab + nsibs_cat + intact,
data = graduation_clean,
family = binomial
)
summary(m_factor2)
anova(log_one, m_factor2, test = "LRT")
log_one <- glm(data = graduation_clean,
hsgrad ~ nonwhite + mhs + fhs + income + asvab + nsibs + intact,
family = binomial(link = "logit"))
summary(log_one)
anova(log_one, m_factor2, test = "LRT")
log_one <- glm(data = graduation_clean,
hsgrad ~ nonwhite + mhs + fhs + income + asvab + nsibs_cat + intact,
family = binomial(link = "logit"))
summary(log_one)
anova(log_one, m_factor2, test = "LRT")
log_one <- glm(data = graduation_clean,
hsgrad ~ nonwhite + mhs + fhs + income + asvab + nsibs_cat + intact,
family = binomial(link = "logit"))
summary(log_one)
anova(log_one, m_factor2, test = "LRT")
log_one <- glm(data = graduation_clean,
hsgrad ~ nonwhite + mhs + fhs + income + asvab + nsibs + intact,
family = binomial(link = "logit"))
summary(log_one)
anova(log_one, m_factor2, test = "LRT")
